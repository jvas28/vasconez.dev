{"componentChunkName":"component---src-templates-blog-template-js","path":"/posts/2","result":{"data":{"markdownRemark":{"html":"<h1>Getting started</h1>\n<p>The starting point for this tutorial is the project we have created on\n<a href=\"/vasconez.dev/posts/1\">Using echarts with react without libraries</a>.</p>\n<p>We should have something like this</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vasconez.dev/static/5f12323233653bb90a3eca4b8649cf21/4ad3a/ss2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACQElEQVQ4y61TW2sTURDe/yYWLLZURQTxVq0WCwqFgoJv4pv4ru/iQyAQEhMSDHnUJt0mTdNSa9RisptNNvfL3nfzOXOaSEoJCLrwcc7OmfPNnG9mpHK5jF6vh263KzAcDqGqKprNJvr9vvjnfaPRwGAwED6Kogh7u91Gp9NBEATgbzweQwqFQkgmk4hGo0ilUsjlckin0wiHw4hEIpBlWZzFYjGxZjIZsSYSCcTjceHDQf4QmqaJf/2YaArJsqxzxikwu//LT9I0Db7vCx3OgA4DIgomhH3S2XIcjE5+wqjV4LgubNuGwyC7TYnxPYkF5wOR5QSB58HpdghdeKORODNp1ahI+8+28P3De7TIR61WUa/XUaekVAIHkSqVCiwi9AmuacCjSHarBY9t5ODTRc5wSGR108Lhq5coPtnASfwjNKo8kzXprPrtGA7VQ2roOkwyuP0eXGoFj1rDJ9LxrK70FIOedfTuLQoP70NeWcLRm9fQKZhGWf5Kf4J89xaGRCpxz9kTgmAK1m5GTya0CPnHj7CzchmF1TsovXiOH8kEKtlt7D24hy8LF04Jayyw455qyJfnVNugbAqbTyFfWcbe2iryt28iu7ggyIvra9i+dBEjJtTpySMS3CW9puCqMaZ7DuRQwPzWJnLXryJPBLv09OyNa9il7Aob6/i8vIgBE/J4caW525mc9zyKbOfRYnBb+USqHB5ALRahlEqo0lor7UM//gqV7NVCHjYl9l8m5UxjG4Yxd1LOYVKguSCf3zpyChVgJpALAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Start\"\n        title=\"Start\"\n        src=\"/vasconez.dev/static/5f12323233653bb90a3eca4b8649cf21/5a190/ss2.png\"\n        srcset=\"/vasconez.dev/static/5f12323233653bb90a3eca4b8649cf21/772e8/ss2.png 200w,\n/vasconez.dev/static/5f12323233653bb90a3eca4b8649cf21/e17e5/ss2.png 400w,\n/vasconez.dev/static/5f12323233653bb90a3eca4b8649cf21/5a190/ss2.png 800w,\n/vasconez.dev/static/5f12323233653bb90a3eca4b8649cf21/4ad3a/ss2.png 1152w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>But, what happens when window is resized and my wrappers shrinks or grows? ðŸ˜®</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vasconez.dev/static/5902bd69adfaa8b9255364b52aaf4d61/2bef9/ss1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACBklEQVQ4y81TS08TURS+/4bEGFy40ADRhREjGxKJf4GERAOIxIUhEsKWsCT+A9QVIC59JNKJ7KDTVkirNi1t6bz6nM7cmennOfNIBBsfkYU3+fLN6T33nO88KvCXp9/v/xLCdV1IKX/r6HkeJGFAhgjxEZ1OB5ZlIQiCwfB9sLtNfnq1irqmwSx+Q3ZhDqVXL2E5DhqNBnRdR7PZhOh2uzAMA378MEHAYHXEXq+HnlaHXirhS7GIk4MDvL88hMzyEsqVCmr0W6lchlavQziUgRVyQJ8eepTAs+3w26c72W7DoezcFk78tVBAVU0jdXMUmSeL2L9/D8fra6iYFjSqQPTooWGapMKGJOmSZLsEZq/VgiT0qXRJamtHR9ibmkRu5RmU8VtIP5rFHgXOra7glO51EhYFHFDymfLjOyOfx7urV6DOPYRy9zbU+dkwcHbpKbLPN1DcfR2VnARMhvATE3i+1VwWH8auI7O4AGXiTqhQmRiH+ngeH0evIUMsuDcmlXx+TX7cOQ7Ixyzk8Xb4EtIPZsIeHs5MI3VjJLQ5oEoJBDvy6mi0Dm0aAA+oRX1jm5ntNnGTYNRqOHyxibKSwuftLZwQH+9sh3bhzS4q+58gEjU2TZaXlxed+YzNJfPysx8rJnbi/rrJisW2SEr7w/9dzEH0HcTMdhBBnO/Xv0Lggs//H/A7356wcMnzpcEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Start\"\n        title=\"Start\"\n        src=\"/vasconez.dev/static/5902bd69adfaa8b9255364b52aaf4d61/5a190/ss1.png\"\n        srcset=\"/vasconez.dev/static/5902bd69adfaa8b9255364b52aaf4d61/772e8/ss1.png 200w,\n/vasconez.dev/static/5902bd69adfaa8b9255364b52aaf4d61/e17e5/ss1.png 400w,\n/vasconez.dev/static/5902bd69adfaa8b9255364b52aaf4d61/5a190/ss1.png 800w,\n/vasconez.dev/static/5902bd69adfaa8b9255364b52aaf4d61/2bef9/ss1.png 1024w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\nTada! ðŸ’©, yeah shit happens...</p>\n<p>So let's fix this behaviour</p>\n<p>I found 2 ways to do it, probably there are more, but I'll explain only this 2</p>\n<ul>\n<li>\n<ol>\n<li>Using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Resize_Observer_API\">Resize Observer API</a> a solution for modern browsers.</li>\n</ol>\n</li>\n<li>\n<ol start=\"2\">\n<li>Using <code class=\"language-text\">window.onrize</code> event.</li>\n</ol>\n</li>\n</ul>\n<p>As I normally work for modern browsers my favorite is the first and is shorter too...</p>\n<h3>Using Resize Observer API</h3>\n<p>I'll create a new file for the observer at <code class=\"language-text\">utils/resizeObserver.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> echarts <span class=\"token keyword\">from</span> <span class=\"token string\">\"echarts\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ResizeObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">entries</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  entries<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> target <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> instance <span class=\"token operator\">=</span> echarts<span class=\"token punctuation\">.</span><span class=\"token function\">getInstanceByDom</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>instance<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      instance<span class=\"token punctuation\">.</span><span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This file will return a <code class=\"language-text\">ResizeObserver</code> that will catch all resize events of the DOM Element registered to be observed by it.</p>\n<p>Inside the observer we receive the <code class=\"language-text\">entries</code> argument which are the list of observed DOM Elements that are being resized.</p>\n<p>Also I'm using <code class=\"language-text\">echarts.getInstanceByDom</code> to use the target element to get the current echart instance and resize the chart corresponding to the resized element. </p>\n<p>Let's import react observer in our <code class=\"language-text\">App</code> Component and send it as property to our charts, so we use same observer for both. </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Chart <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Chart\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> line <span class=\"token keyword\">from</span> <span class=\"token string\">\"./charts/line\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> bars <span class=\"token keyword\">from</span> <span class=\"token string\">\"./charts/bars\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> resizeObserver <span class=\"token keyword\">from</span> <span class=\"token string\">\"./utils/resizeObserver\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./App.css\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n   <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n     <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Echarts <span class=\"token keyword\">in</span> React without libraries<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n     <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"App\"</span> style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> display<span class=\"token operator\">:</span> <span class=\"token string\">\"flex\"</span><span class=\"token punctuation\">,</span> flexDirection<span class=\"token operator\">:</span> <span class=\"token string\">\"row\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n       <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> width<span class=\"token operator\">:</span> <span class=\"token string\">\"50%\"</span><span class=\"token punctuation\">,</span> height<span class=\"token operator\">:</span> <span class=\"token number\">300</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n         <span class=\"token operator\">&lt;</span>Chart options<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>line<span class=\"token punctuation\">}</span> resizeObserver<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>resizeObserver<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n       <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n       <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> width<span class=\"token operator\">:</span> <span class=\"token string\">\"50%\"</span><span class=\"token punctuation\">,</span> height<span class=\"token operator\">:</span> <span class=\"token number\">300</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n         <span class=\"token operator\">&lt;</span>Chart options<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>bars<span class=\"token punctuation\">}</span> resizeObserver<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>resizeObserver<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n       <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n     <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n   <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> App<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Then there's only one more thing to do, register our DOM Elements to the <code class=\"language-text\">Resize Observer</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useRef<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">\"prop-types\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> echarts <span class=\"token keyword\">from</span> <span class=\"token string\">\"echarts\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Chart</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> options<span class=\"token punctuation\">,</span> resizeObserver <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n <span class=\"token operator\">...</span><span class=\"token punctuation\">.</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> chart <span class=\"token operator\">=</span> echarts<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span>myChart<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    chart<span class=\"token punctuation\">.</span><span class=\"token function\">setOption</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resizeObserver<span class=\"token punctuation\">)</span> resizeObserver<span class=\"token punctuation\">.</span><span class=\"token function\">observe</span><span class=\"token punctuation\">(</span>myChart<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">,</span> resizeObserver<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span><span class=\"token punctuation\">.</span>\n\nChart<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  options<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>any<span class=\"token punctuation\">,</span>\n  resizeObserver<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">oneOfType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>PropTypes<span class=\"token punctuation\">.</span>func<span class=\"token punctuation\">,</span> PropTypes<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Chart<span class=\"token punctuation\">;</span></code></pre></div>\n<p>We only need to add the property <code class=\"language-text\">resizeObserver</code> and then use it to register the DOM Element inside <code class=\"language-text\">UseEffect</code> Hook.</p>\n<p>And now we have resizable charts ðŸ˜‰</p>","frontmatter":{"date":"March 15, 2020","path":"/posts/2","title":"React echart component resizing","tags":["react","echarts"]}}},"pageContext":{"language":"en","intl":{"language":"en","languages":["es","en"],"messages":{"headline":"Senior Software Engineer","at":"@","location":"Munich, Germany","description":"Husband, father and coder","contact":"Drop me a line"},"routed":false,"originalPath":"/posts/2","redirect":false,"defaultLanguage":"en"}}}}